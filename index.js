import{A as ae,a as H,S as le,R as ue,i as K}from"./assets/vendor-D40M51PX.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}})();new ae(".accordion-container",{duration:300,showMultiple:!1});const de="https://furniture-store-v2.b.goit.study/api",Z={FURNITURES_LIST:"/furnitures",FURNITURE_ITEM:"/furnitures/",CATEGORIES_LIST:"/categories",USERS_ORDER:"/orders",FEEDBACKS:"/feedbacks"};H.defaults.baseURL=de;async function me(e){try{return(await H.post(Z.USERS_ORDER,e)).data}catch(n){throw console.error("Failed to post order.",n),new Error("Order submission failed.")}}async function fe(e){try{const n={limit:10,page:e};return(await H.get(Z.FEEDBACKS,{params:n})).data.feedbacks}catch(n){throw console.error("Failed to fetch feedbacks.",n),new Error("Fetch feedbacks data error")}}const pe=document.querySelector(".swiper-wrapper"),ge=new le(".swiper",{direction:"horizontal",loop:!1,slidesPerView:1,spaceBetween:48,breakpoints:{768:{slidesPerView:2,spaceBetween:24},1440:{slidesPerView:3,spaceBetween:32}},effect:"slide",grabCursor:!0,freeMode:!0,autoHeight:!1,spaceBetween:24,autoplay:{delay:5e3},pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}});function ye(){document.querySelectorAll(".rating").forEach(e=>{new ue(e,{score:e.dataset.score,starSize:20,step:.5,score:e.dataset.score,readOnly:!0,numberMax:5,precision:!1,round:{down:.3,full:.7,up:.8},path:"./img/star-icons",starOn:"star-full.png",starHalf:"star-half.png",starOff})})}function he(e){return e.map(({name:n,descr:o,rate:a})=>`
    <div class="swiper-slide">
      <div class="comment-card">
        <div class="rating" data-score="${a}"></div>
        <p class="comment-descr">"${o}"</p>
        <h3 class="comment-name">${n}</h3>
      </div>
    </div>
    `).join(`
`)}function be(e){pe.insertAdjacentHTML("beforeend",he(e)),ye(),ge.update()}let ve=1;async function Ee(){try{const e=await fe(ve);be(e)}catch(e){console.log(e)}}Ee();(function(){const e=document.getElementById("furnitureModal"),n=e.querySelector(".furn-modal__main-img"),o=e.querySelector(".furn-modal__thumbs"),a=e.querySelector(".furn-modal__title"),r=e.querySelector(".furn-modal__category"),s=e.querySelector(".furn-modal__price"),d=e.querySelector(".furn-modal__rating"),y=e.querySelector(".furn-modal__colors"),L=e.querySelector(".furn-modal__desc"),w=e.querySelector(".furn-modal__sizes"),b=e.querySelector(".furn-modal__order");let _=null;const I=((t,i=document)=>i.querySelector(t))("#categories-list"),ne=(t,i,f)=>Math.max(i,Math.min(f,t));function oe(t){return t?typeof t=="string"?t:typeof t=="object"?t.name??t.title??t.label??Object.values(t).find(i=>typeof i=="string")??"":"":""}function re(t){const i=t.rating;return typeof i=="number"?i:i&&typeof i=="object"?i.value??i.rate??i.score??i.stars??0:typeof t.stars=="number"?t.stars:typeof t.score=="number"?t.score:typeof t.popularity=="number"?Math.min(5,t.popularity):4.8}function se(t){const i=Array.isArray(t.colors||t.colours)?t.colors||t.colours:[],f=u=>typeof u=="string"?u:u&&(u.hex??u.color??u.value??u.name)||null,E=i.map(f).filter(Boolean);return E.length?E:["#111","#c0c0c0","#f5f5f5"]}function ie(){e.hidden=!1,document.body.classList.add("no-scroll"),e.querySelector("[data-close]").focus({preventScroll:!0}),window.addEventListener("keydown",U)}function T(){e.hidden=!0,document.body.classList.remove("no-scroll"),window.removeEventListener("keydown",U)}function U(t){t.key==="Escape"&&T()}e.addEventListener("click",t=>{(t.target===e||t.target.closest("[data-close]"))&&T()});function ce(){const t=y.querySelector('input[name="color"]:checked');return t?t.value:null}b.addEventListener("click",()=>{const t={productId:_==null?void 0:_._id,title:a.textContent,color:ce()};T(),document.dispatchEvent(new CustomEvent("open-order-modal",{detail:t})),typeof window.openOrderModal=="function"&&window.openOrderModal(t)});function z(t){var V;_=t;const i=t.title||t.name||"Модель",f=oe(t.category),E=t.price,u=ne(Number(re(t))||0,0,5),M=(V=t.images)!=null&&V.length?t.images:t.image?[t.image]:[],C=t.description||"",$=se(t),v=t.size||t.sizes||t.dimensions||{};a.textContent=i,r.textContent=f,s.textContent=E!=null?`${E} грн`:"",d.style.setProperty("--value",u);const x=M.length?M:[""];n.src=x[0]||"",n.alt=i;const A=x.slice(1,3);o.innerHTML=A.map((c,p)=>`<li>
          <button type="button" aria-label="Зображення ${p+2}">
            <img src="${c}" alt="${i}">
          </button>
        </li>`).join(""),o.onclick=c=>{const p=c.target.closest("button");if(!p)return;const g=p.querySelector("img");g&&(n.src=g.src,o.querySelectorAll("img").forEach(S=>S.removeAttribute("aria-current")),g.setAttribute("aria-current","true"))},y.innerHTML="",$.forEach((c,p)=>{const g=document.createElement("label");g.className="furn-color",g.style.background=c,g.title=typeof c=="string"?c:"Колір";const S=document.createElement("input");S.type="checkbox",S.name="color",S.value=c,p===0&&(S.checked=!0),g.appendChild(S),y.appendChild(g)}),y.onchange=c=>{c.target.name==="color"&&[...y.querySelectorAll('input[name="color"]')].forEach(p=>{p!==c.target&&(p.checked=!1)})},L.textContent=C,w.innerHTML="";const m=typeof v=="object"&&v?v:{},k=m.width||m.w||m.W,q=m.height||m.h||m.H,B=m.depth||m.length||m.d||m.L;if(k&&q&&B)w.innerHTML=`<li>Розміри: ${k} x ${q} x ${B}</li>`;else{const c=[];k&&c.push(`Ширина: ${k}`),q&&c.push(`Висота: ${q}`),B&&c.push(`Глибина: ${B}`);const p=typeof v=="string"?[v]:[];w.innerHTML=[...c,...p].map(g=>`<li>${g}</li>`).join("")}}I==null||I.addEventListener("click",t=>{var C,$,v,x,A;if(!t.target.closest("[data-modal-open]"))return;t.preventDefault();const f=t.target.closest(".furniture-item");if(!f)return;const E=f.dataset.id,u=window.__productsCache instanceof Map?window.__productsCache:null,M=u==null?void 0:u.get(E);if(M)z(M);else{const m=($=(C=f.querySelector(".gallery-title"))==null?void 0:C.textContent)==null?void 0:$.trim(),k=(v=f.querySelector(".furniture-image"))==null?void 0:v.src,q=(A=(x=f.querySelector(".furniture-price"))==null?void 0:x.textContent)==null?void 0:A.trim();z({title:m,images:[k],price:q})}ie()})})();function Se(e,n=!1){const o=e.map(({_id:a,images:r,name:s,color:d,price:y})=>{const L=(r==null?void 0:r[0])||"https://via.placeholder.com/300x200?text=No+Image",w=Array.isArray(d)?d.map(b=>`<span style="display:inline-block;width:24px;height:24px;border-radius:50%;background:${b};margin:0 2px;"></span>`).join(""):"—";return`
        <li class="furniture-item" data-id="${a}">
          <img class="furniture-item-img" src="${L}" alt="${s}" style="width: 310px; height: 256px; object-fit: cover; border-radius: 8px;" />
          <h3 class="furniture-item-name">${s}</h3>
          <p class="furniture-item-color">${w}</p>
          <p class="furniture-item-price">${y} грн</p>
          <a href="/product/${a}" class="furniture-item-more">Детальніше</a>
        </li>
      `}).join("");n?W.innerHTML=o:W.insertAdjacentHTML("beforeend",o)}const W=document.querySelector(".furniture-list"),Le=document.querySelector(".categories-list-item"),F=document.querySelector(".load-more-btn");let O=1;const G=8;let j=0,J=0,N=null;async function P(e=1,n=null){try{let o=`https://furniture-store-v2.b.goit.study/api/furnitures?page=${e}&limit=${G}`;n&&n!=="all"&&(o+=`&category=${n}`);const r=await(await fetch(o)).json(),s=r.furnitures;J=r.total,Se(s,e===1),j+=s.length,j>=J||s.length<G?F.style.display="none":F.style.display="block"}catch(o){console.error("Error loading furniture:",o)}}Le.addEventListener("click",e=>{const n=e.target.closest("li[data-category-id]");n&&(N=n.dataset.categoryId,O=1,j=0,P(O,N))});P();F.addEventListener("click",()=>{O++,P(O,N)});const Q=document.querySelectorAll(".img-categories");Q.forEach(e=>{e.addEventListener("click",()=>{Q.forEach(n=>n.classList.remove("active")),e.classList.add("active")})});const h={openModalBtn:document.querySelector("[data-modal-open]"),closeModalBtn:document.querySelector("[data-modal-close]"),modal:document.querySelector("[data-modal]"),body:document.querySelector("body"),form:document.querySelector(".modal-form")};h.openModalBtn.addEventListener("click",ee);h.closeModalBtn.addEventListener("click",ee);h.modal.addEventListener("click",we);window.addEventListener("keydown",ke);h.form.addEventListener("submit",qe);function ee(){h.modal.classList.toggle("is-open"),h.body.classList.toggle("modal-open")}function D(){h.modal.classList.remove("is-open"),h.body.classList.remove("modal-open")}function we(e){e.target===h.modal&&D()}function ke(e){e.key==="Escape"&&h.modal.classList.contains("is-open")&&D()}function qe(e){e.preventDefault();const n=e.currentTarget,{name:o,phone:a,comment:r}=n.elements,s=r.value;Y(o),Y(a);let d=!0;const y=o.value.trim();y.length<2&&(X(o,"Будь ласка, введіть правильно ім'я"),d=!1);const L=a.value.trim().replace(/\s+/g,"");/^(\+?38)?0\d{9}$/.test(L)||(X(a,"Невірний формат телефону"),d=!1),d&&me({name:y,phone:L,modelId:"",color:"",comment:s}).then(b=>{console.log(b),K.success({title:"Вітаю!",message:"Ваше замовлення оформлено успішно!",position:"topRight"}),n.reset(),D()}).catch(b=>{console.error("Failed to post order.",b.message),K.error({title:"Помилка",message:`${b.message}`,position:"topRight"})})}function X(e,n){if(e.classList.add("invalid"),!e.nextElementSibling||!e.nextElementSibling.classList.contains("error-text")){const o=document.createElement("p");o.className="error-text",o.textContent=n,e.insertAdjacentElement("afterend",o)}}function Y(e){e.classList.remove("invalid"),e.nextElementSibling&&e.nextElementSibling.classList.contains("error-text")&&e.nextElementSibling.remove()}const l={openBtn:document.querySelector("#menu-open-btn"),closeBtn:document.querySelector("#menu-close-btn"),mobileMenu:document.querySelector("#mobile-menu-container"),mobaleNavList:document.querySelector("#mobile-nav"),navigation:document.querySelector(".navigation"),overlay:document.querySelector("#menu-overlay"),btn:document.querySelector(".btn-header")};l.openBtn.addEventListener("click",Me);l.closeBtn.addEventListener("click",R);document.addEventListener("keydown",xe);document.addEventListener("click",_e);l.btn.addEventListener("click",Ce);function Me(){l.mobileMenu.classList.add("is-open"),l.navigation.classList.add("menu-active"),l.overlay.classList.add("is-visible"),document.body.style.overflow="hidden",l.openBtn.setAttribute("aria-expanded","true")}function R(){l.mobileMenu.classList.remove("is-open"),l.navigation.classList.remove("menu-active"),l.overlay.classList.remove("is-visible"),document.body.style.overflow="",l.openBtn.setAttribute("aria-expanded","false")}l.mobaleNavList.querySelectorAll("a").forEach(e=>{e.addEventListener("click",R)});function te(){l.mobileMenu.classList.contains("is-open")&&R()}function xe(e){e.key==="Escape"&&te()}function _e(e){const n=l.mobileMenu.contains(e.target),o=l.openBtn.contains(e.target);!n&&!o&&te()}function Ce(){document.querySelector("#furniture").scrollIntoView({behavior:"smooth"}),R()}
//# sourceMappingURL=index.js.map
